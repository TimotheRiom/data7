package cve.model;

import cve.parser.CVE;

import java.io.Serializable;
import java.util.*;

public class Vulnerability implements Serializable {


    private final Map<String, CommitInterest> patchingCommits;
    private final String cve;
    private final String description;

    private Set<String> bugIds;
    private long lastModified;
    private String cwe;
    private String score;

    public Vulnerability(String cve, String description, long lastModified) {
        this.patchingCommits = new HashMap<>();
        this.cve = cve;
        this.description = description;
        this.lastModified = lastModified;
        bugIds = new HashSet<>();
        cwe = null;
        score = null;
    }

    public Vulnerability(CVE cve) {
        this.patchingCommits = new HashMap<>();
        this.cve = cve.CVE;
        this.description = cve.description;
        this.lastModified = cve.lastModified;
        bugIds = new HashSet<>();
        cwe = cve.CWE;
        score = cve.score;
    }


    public String getCwe() {
        return cwe;
    }

    public Map<String, CommitInterest> getPatchingCommits() {
        return patchingCommits;
    }

    public String getCve() {
        return cve;
    }

    public String getDescription() {
        return description;
    }

    public long getLastModified() {
        return lastModified;
    }

    public String getScore() {
        return score;
    }

    public Set<String> getBugId() {
        return bugIds;
    }

    public void addbug(String bugId) {
        this.bugIds.add(bugId);
    }

    public void setLastModified(long lastModified) {
        this.lastModified = lastModified;
    }

    public void setCwe(String cwe) {
        this.cwe = cwe;
    }

    public void setScore(String score) {
        this.score = score;
    }
}
